<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 1 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 1";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Theoretical Foundation of Projectile Motion</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Theoretical Foundation: Forced Damped Pendulum</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 1</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Problem 1</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-1">Problem 1</h1>
<h1 id="research-applications-of-the-lorentz-force">Research Applications of the Lorentz Force</h1>
<p>The Lorentz force, expressed as:</p>
<div class="arithmatex">\[\mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right),\]</div>
<p>is fundamental in electromagnetism, describing the force on a charged particle in electric (<span class="arithmatex">\(\mathbf{E}\)</span>) and magnetic (<span class="arithmatex">\(\mathbf{B}\)</span>) fields. Below are key applications:</p>
<h2 id="1-cyclotrons-particle-acceleration">1. Cyclotrons: Particle Acceleration</h2>
<p>Cyclotrons use <span class="arithmatex">\(\mathbf{B}\)</span> to steer particles into circular orbits and <span class="arithmatex">\(\mathbf{E}\)</span> to accelerate them. The magnetic force provides centripetal motion:</p>
<div class="arithmatex">\[r = \frac{m v_\perp}{|q| B}, \quad \omega = \frac{|q| B}{m}.\]</div>
<p><span class="arithmatex">\(\mathbf{E}\)</span> increases kinetic energy as particles spiral outward. Applications include proton therapy and radioisotope production.</p>
<h2 id="2-mass-spectrometers-charge-to-mass-ratio">2. Mass Spectrometers: Charge-to-Mass Ratio</h2>
<p>Mass spectrometers analyze <span class="arithmatex">\(m/q\)</span> by combining <span class="arithmatex">\(\mathbf{E}\)</span> for ion acceleration and <span class="arithmatex">\(\mathbf{B}\)</span> for deflection:</p>
<div class="arithmatex">\[r = \frac{1}{B} \sqrt{\frac{2 m V}{|q|}}.\]</div>
<p>Distinct ion trajectories enable precise molecular identification in fields like proteomics.</p>
<h2 id="3-tokamaks-plasma-confinement">3. Tokamaks: Plasma Confinement</h2>
<p>Tokamaks confine plasma for fusion using helical <span class="arithmatex">\(\mathbf{B}\)</span> fields. The Lorentz force confines particles to spiral paths:</p>
<div class="arithmatex">\[r_g = \frac{m v_\perp}{|q| B}.\]</div>
<p>Drifts, such as <span class="arithmatex">\(\mathbf{v}_{E \times B} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}\)</span>, are managed to maintain stability. ITER aims to achieve net energy gain.</p>
<h2 id="4-other-applications">4. Other Applications</h2>
<ul>
<li><strong>MHD Generators</strong>: Convert thermal energy to electricity via <span class="arithmatex">\(\mathbf{J} = \sigma (\mathbf{E} + \mathbf{v} \times \mathbf{B})\)</span>.</li>
<li><strong>Astrophysical Plasmas</strong>: Govern phenomena like auroras and cosmic ray motion in stellar magnetic fields.</li>
</ul>
<p>The Lorentz force underpins technologies and natural processes, highlighting its universal significance.</p>
<h1 id="implement-simulations-for-specific-field-configurations">Implement Simulations for Specific Field Configurations</h1>
<h2 id="simulating-charged-particle-motion">Simulating Charged Particle Motion</h2>
<p>To explore the Lorentz force effects, simulations are implemented for three field configurations: uniform magnetic field, combined electric and magnetic fields, and crossed electric and magnetic fields. Each setup demonstrates unique trajectory characteristics governed by:</p>
<div class="arithmatex">\[\mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)\]</div>
<p>where <span class="arithmatex">\(q\)</span> is the charge, <span class="arithmatex">\(\mathbf{E}\)</span> the electric field, <span class="arithmatex">\(\mathbf{v}\)</span> the velocity, and <span class="arithmatex">\(\mathbf{B}\)</span> the magnetic field. The equations of motion, derived from <span class="arithmatex">\(\mathbf{F} = m \mathbf{a}\)</span>, are solved numerically using the RK4 method with NumPy and Matplotlib.</p>
<h3 id="1-uniform-magnetic-field">1. Uniform Magnetic Field</h3>
<ul>
<li><strong>Setup</strong>: <span class="arithmatex">\(\mathbf{E} = \mathbf{0}\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>.</li>
<li><strong>Equations</strong>:
    <span class="arithmatex">\(<span class="arithmatex">\(\frac{d v_x}{dt} = -\frac{q B_z}{m} v_y, \quad \frac{d v_y}{dt} = \frac{q B_z}{m} v_x, \quad \frac{d v_z}{dt} = 0\)</span>\)</span>
<span class="arithmatex">\(<span class="arithmatex">\(\frac{d x}{dt} = v_x, \quad \frac{d y}{dt} = v_y, \quad \frac{d z}{dt} = v_z\)</span>\)</span></li>
<li><strong>Motion</strong>:<ul>
<li>Circular in the xy-plane with radius <span class="arithmatex">\(r_L = \frac{m v_\perp}{|q| B_z}\)</span>.</li>
<li>Helical if <span class="arithmatex">\(v_z \neq 0\)</span>.</li>
</ul>
</li>
<li><strong>Simulation</strong>: Initialize <span class="arithmatex">\(q, m, \mathbf{v}_0\)</span>, solve ODEs, and plot 3D trajectory.</li>
</ul>
<h3 id="2-combined-electric-and-magnetic-fields">2. Combined Electric and Magnetic Fields</h3>
<ul>
<li><strong>Setup</strong>: <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>.</li>
<li><strong>Equations</strong>:
    <span class="arithmatex">\(<span class="arithmatex">\(\frac{d v_x}{dt} = \frac{q}{m} (E_x - v_y B_z), \quad \frac{d v_y}{dt} = \frac{q}{m} v_x B_z, \quad \frac{d v_z}{dt} = 0\)</span>\)</span>
<span class="arithmatex">\(<span class="arithmatex">\(\frac{d x}{dt} = v_x, \quad \frac{d y}{dt} = v_y, \quad \frac{d z}{dt} = v_z\)</span>\)</span></li>
<li><strong>Motion</strong>:<ul>
<li>Gyration in the xy-plane.</li>
<li>Drift or trochoidal paths due to <span class="arithmatex">\(\mathbf{E}\)</span>.</li>
<li>Helical if <span class="arithmatex">\(v_z \neq 0\)</span>.</li>
</ul>
</li>
<li><strong>Simulation</strong>: Solve ODEs with <span class="arithmatex">\(\mathbf{E}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span>, plot trajectory.</li>
</ul>
<h3 id="3-crossed-electric-and-magnetic-fields">3. Crossed Electric and Magnetic Fields</h3>
<ul>
<li><strong>Setup</strong>: <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>.</li>
<li><strong>Equations</strong>: Same as combined fields.</li>
<li><strong>Motion</strong>:<ul>
<li><span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> drift: <span class="arithmatex">\(\mathbf{v}_{E \times B} = \frac{\mathbf{E} \times \mathbf{B}}{B^2} = (0, \frac{E_x}{B_z}, 0)\)</span>.</li>
<li>Helical trajectory with drift along y-axis.</li>
</ul>
</li>
<li><strong>Simulation</strong>: Solve ODEs, highlight drift velocity <span class="arithmatex">\(v_d = \frac{E_x}{B_z}\)</span> in plots.</li>
</ul>
<p>Each simulation visualizes the interplay of <span class="arithmatex">\(\mathbf{E}\)</span>, <span class="arithmatex">\(\mathbf{B}\)</span>, and <span class="arithmatex">\(\mathbf{v}\)</span>, emphasizing the Lorentz force's role in shaping particle motion.</p>
<p>To explore the effects of the Lorentz force, simulations of charged particle motion under distinct field configurations are implemented. This section details the setup and simulation strategies for three cases: a uniform magnetic field, combined electric and magnetic fields, and crossed electric and magnetic fields. Each configuration highlights unique trajectory characteristics, such as circular, helical, or drift motion, governed by the Lorentz force equation:</p>
<div class="arithmatex">\[\mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)\]</div>
<p>where <span class="arithmatex">\(q\)</span> is the particle's charge (C), <span class="arithmatex">\(\mathbf{E}\)</span> is the electric field (V/m), <span class="arithmatex">\(\mathbf{v}\)</span> is the velocity (m/s), and <span class="arithmatex">\(\mathbf{B}\)</span> is the magnetic field (T). The equations of motion, derived from <span class="arithmatex">\(\mathbf{F} = m \mathbf{a}\)</span>, are solved numerically using the framework established previously (e.g., RK4 method with NumPy and Matplotlib).</p>
<h2 id="1-uniform-magnetic-field_1">1. Uniform Magnetic Field</h2>
<h3 id="configuration">Configuration</h3>
<p>In this scenario, the electric field is set to zero (<span class="arithmatex">\(\mathbf{E} = \mathbf{0}\)</span>), and a uniform magnetic field <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span> is applied, where <span class="arithmatex">\(B_z\)</span> is a constant (e.g., <span class="arithmatex">\(B_z = 1\)</span> T). The Lorentz force simplifies to:</p>
<div class="arithmatex">\[\mathbf{F} = q \mathbf{v} \times \mathbf{B}\]</div>
<p>For a particle with velocity <span class="arithmatex">\(\mathbf{v} = (v_x, v_y, v_z)\)</span>, the cross product yields a force perpendicular to both <span class="arithmatex">\(\mathbf{v}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span>, resulting in curved trajectories.</p>
<h3 id="equations-of-motion">Equations of Motion</h3>
<p>The acceleration is:</p>
<div class="arithmatex">\[\mathbf{a} = \frac{d \mathbf{v}}{dt} = \frac{q}{m} \mathbf{v} \times \mathbf{B}\]</div>
<p>For <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>, the cross product is:</p>
<div class="arithmatex">\[\mathbf{v} \times \mathbf{B} = \begin{vmatrix}
\hat{x} &amp; \hat{y} &amp; \hat{z} \\
v_x &amp; v_y &amp; v_z \\
0 &amp; 0 &amp; B_z
\end{vmatrix} = (-v_y B_z, v_x B_z, 0)\]</div>
<p>Thus, the equations of motion are:</p>
<div class="arithmatex">\[\frac{d v_x}{dt} = -\frac{q B_z}{m} v_y, \quad \frac{d v_y}{dt} = \frac{q B_z}{m} v_x, \quad \frac{d v_z}{dt} = 0\]</div>
<div class="arithmatex">\[\frac{d x}{dt} = v_x, \quad \frac{d y}{dt} = v_y, \quad \frac{d z}{dt} = v_z\]</div>
<h3 id="trajectory-characteristics">Trajectory Characteristics</h3>
<ul>
<li><strong>Circular Motion</strong>: If the initial velocity has components only perpendicular to <span class="arithmatex">\(\mathbf{B}\)</span> (e.g., <span class="arithmatex">\(\mathbf{v}_0 = (v_x, v_y, 0)\)</span>), the particle follows a circular path in the xy-plane. The radius (Larmor radius) is:</li>
</ul>
<div class="arithmatex">\[r_L = \frac{m v_\perp}{|q| B_z}\]</div>
<p>where <span class="arithmatex">\(v_\perp = \sqrt{v_x^2 + v_y^2}\)</span> is the speed in the plane perpendicular to <span class="arithmatex">\(\mathbf{B}\)</span>. The cyclotron frequency is:</p>
<div class="arithmatex">\[\omega = \frac{|q| B_z}{m}\]</div>
<ul>
<li><strong>Helical Motion</strong>: If the initial velocity includes a component parallel to <span class="arithmatex">\(\mathbf{B}\)</span> (e.g., <span class="arithmatex">\(v_z \neq 0\)</span>), the particle follows a helical path, with circular motion in the xy-plane superimposed on linear motion along the z-axis at constant speed <span class="arithmatex">\(v_z\)</span>.</li>
</ul>
<h3 id="simulation-strategy">Simulation Strategy</h3>
<ul>
<li>Initialize the particle with parameters (e.g., <span class="arithmatex">\(q = 1.6 \times 10^{-19}\)</span> C, <span class="arithmatex">\(m = 1.67 \times 10^{-27}\)</span> kg, <span class="arithmatex">\(\mathbf{v}_0 = (10^5, 10^5, 10^5)\)</span> m/s).</li>
<li>Set <span class="arithmatex">\(\mathbf{E} = \mathbf{0}\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, 1)\)</span> T.</li>
<li>Use the RK4 method to solve the ODEs over a time interval (e.g., <span class="arithmatex">\(T = 10^{-6}\)</span> s, <span class="arithmatex">\(\Delta t = 10^{-9}\)</span> s).</li>
<li>Plot the trajectory in 3D using Matplotlib, highlighting the Larmor radius and cyclotron period for circular or helical motion.</li>
</ul>
<h2 id="2-combined-electric-and-magnetic-fields_1">2. Combined Electric and Magnetic Fields</h2>
<h3 id="configuration_1">Configuration</h3>
<p>Here, both electric and magnetic fields are non-zero and constant, but not necessarily perpendicular (e.g., <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>). The Lorentz force is:</p>
<div class="arithmatex">\[\mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)\]</div>
<p>The electric field introduces a linear acceleration, while the magnetic field induces curved motion, leading to complex trajectories.</p>
<h3 id="equations-of-motion_1">Equations of Motion</h3>
<p>The acceleration is:</p>
<div class="arithmatex">\[\mathbf{a} = \frac{d \mathbf{v}}{dt} = \frac{q}{m} \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)\]</div>
<p>For <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>, the force components are:</p>
<div class="arithmatex">\[\mathbf{v} \times \mathbf{B} = (-v_y B_z, v_x B_z, 0)\]</div>
<div class="arithmatex">\[\mathbf{E} + \mathbf{v} \times \mathbf{B} = (E_x - v_y B_z, v_x B_z, 0)\]</div>
<p>Thus, the equations of motion are:</p>
<div class="arithmatex">\[\frac{d v_x}{dt} = \frac{q}{m} (E_x - v_y B_z), \quad \frac{d v_y}{dt} = \frac{q}{m} v_x B_z, \quad \frac{d v_z}{dt} = 0\]</div>
<div class="arithmatex">\[\frac{d x}{dt} = v_x, \quad \frac{d y}{dt} = v_y, \quad \frac{d z}{dt} = v_z\]</div>
<h3 id="trajectory-characteristics_1">Trajectory Characteristics</h3>
<p>The trajectory depends on the relative orientation of <span class="arithmatex">\(\mathbf{E}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span> and the initial velocity:
- The magnetic field causes gyration in the xy-plane, similar to the uniform <span class="arithmatex">\(\mathbf{B}\)</span> case.
- The electric field adds a constant acceleration along <span class="arithmatex">\(\mathbf{E}\)</span>, modifying the center of gyration and potentially leading to a trochoidal or drifting path.
- If <span class="arithmatex">\(v_z \neq 0\)</span>, the motion includes a linear component along the z-axis, resulting in a helical trajectory with a drifting guiding center.</p>
<h3 id="simulation-strategy_1">Simulation Strategy</h3>
<ul>
<li>Initialize the particle with the same parameters as above.</li>
<li>Set <span class="arithmatex">\(\mathbf{E} = (10^5, 0, 0)\)</span> V/m, <span class="arithmatex">\(\mathbf{B} = (0, 0, 1)\)</span> T.</li>
<li>Solve the ODEs using RK4, ensuring the time step <span class="arithmatex">\(\Delta t\)</span> captures both the cyclotron motion and electric field effects.</li>
<li>Plot the 3D trajectory, labeling the effects of <span class="arithmatex">\(\mathbf{E}\)</span> (e.g., drift or acceleration) and <span class="arithmatex">\(\mathbf{B}\)</span> (e.g., gyration radius).</li>
</ul>
<h2 id="3-crossed-electric-and-magnetic-fields_1">3. Crossed Electric and Magnetic Fields</h2>
<h3 id="configuration_2">Configuration</h3>
<p>In this case, the electric and magnetic fields are perpendicular (e.g., <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>), leading to a characteristic drift motion known as the <span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> drift. The Lorentz force is:</p>
<div class="arithmatex">\[\mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right)\]</div>
<h3 id="equations-of-motion_2">Equations of Motion</h3>
<p>The equations are identical to the combined fields case, as the fields are still <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>:</p>
<div class="arithmatex">\[\frac{d v_x}{dt} = \frac{q}{m} (E_x - v_y B_z), \quad \frac{d v_y}{dt} = \frac{q}{m} v_x B_z, \quad \frac{d v_z}{dt} = 0\]</div>
<div class="arithmatex">\[\frac{d x}{dt} = v_x, \quad \frac{d y}{dt} = v_y, \quad \frac{d z}{dt} = v_z\]</div>
<h3 id="trajectory-characteristics_2">Trajectory Characteristics</h3>
<p>The perpendicular orientation of <span class="arithmatex">\(\mathbf{E}\)</span> and <span class="arithmatex">\(\mathbf{B}\)</span> introduces a drift velocity perpendicular to both fields, known as the <span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> drift. For <span class="arithmatex">\(\mathbf{E} = (E_x, 0, 0)\)</span>, <span class="arithmatex">\(\mathbf{B} = (0, 0, B_z)\)</span>, the drift velocity is:</p>
<div class="arithmatex">\[\mathbf{v}_{E \times B} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}\]</div>
<p>Computing the cross product:</p>
<div class="arithmatex">\[\mathbf{E} \times \mathbf{B} = \begin{vmatrix}
\hat{x} &amp; \hat{y} &amp; \hat{z} \\
E_x &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; B_z
\end{vmatrix} = (0, E_x B_z, 0)\]</div>
<div class="arithmatex">\[\mathbf{v}_{E \times B} = \left( 0, \frac{E_x}{B_z}, 0 \right)\]</div>
<p>The particle's motion consists of:
- <strong>Gyration</strong>: Circular motion in the xy-plane due to <span class="arithmatex">\(\mathbf{B}\)</span>, with radius <span class="arithmatex">\(r_L = \frac{m v_\perp}{|q| B_z}\)</span>.
- <strong>Drift</strong>: Linear motion in the y-direction at speed <span class="arithmatex">\(v_d = \frac{E_x}{B_z}\)</span>.
- <strong>Parallel Motion</strong>: If <span class="arithmatex">\(v_z \neq 0\)</span>, linear motion along the z-axis.</p>
<p>The resulting trajectory is a helix with a drifting guiding center along the y-axis.</p>
<h3 id="simulation-strategy_2">Simulation Strategy</h3>
<ul>
<li>Use the same particle parameters as above.</li>
<li>Set <span class="arithmatex">\(\mathbf{E} = (10^5, 0, 0)\)</span> V/m, <span class="arithmatex">\(\mathbf{B} = (0, 0, 1)\)</span> T, ensuring perpendicularity.</li>
<li>Solve the ODEs using RK4, with a time step <span class="arithmatex">\(\Delta t\)</span> small enough to resolve the cyclotron motion (e.g., <span class="arithmatex">\(\Delta t &lt; \frac{2\pi m}{|q| B_z}\)</span>).</li>
<li>Plot the 3D trajectory, highlighting the <span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> drift in the y-direction and the gyroradius. Include annotations for the drift velocity <span class="arithmatex">\(v_d = \frac{E_x}{B_z}\)</span>.</li>
</ul>
<h1 id="incorporate-parameter-variations">Incorporate Parameter Variations</h1>
<h2 id="investigating-parameter-variations-in-lorentz-force-dynamics">Investigating Parameter Variations in Lorentz Force Dynamics</h2>
<p>To analyze how variations in key parameters affect charged particle trajectories, modular functions are developed to adjust electric and magnetic field strengths (<span class="arithmatex">\(\mathbf{E}\)</span>, <span class="arithmatex">\(\mathbf{B}\)</span>), initial velocity (<span class="arithmatex">\(\mathbf{v}\)</span>), charge (<span class="arithmatex">\(q\)</span>), and mass (<span class="arithmatex">\(m\)</span>). Numerical simulations using the RK4 method with NumPy and Matplotlib enable detailed exploration of trajectory shapes, Larmor radius, and drift velocities.</p>
<h3 id="1-parameter-adjustment-functions">1. Parameter Adjustment Functions</h3>
<ul>
<li>
<p><strong>Field Strengths (<span class="arithmatex">\(\mathbf{E}\)</span>, <span class="arithmatex">\(\mathbf{B}\)</span>)</strong>:</p>
<ul>
<li>Functions <code>set_electric_field(E_x, E_y, E_z)</code> and <code>set_magnetic_field(B_x, B_y, B_z)</code> allow scalar inputs for uniform or crossed fields.</li>
<li>Test effects on curvature and drift by varying <span class="arithmatex">\(B_z\)</span> (e.g., 0.1–10 T) and <span class="arithmatex">\(E_x\)</span> (e.g., <span class="arithmatex">\(10^4\)</span>–<span class="arithmatex">\(10^6\)</span> V/m).</li>
</ul>
</li>
<li>
<p><strong>Initial Velocity (<span class="arithmatex">\(\mathbf{v}\)</span>)</strong>:</p>
<ul>
<li>Function <code>set_initial_velocity(v_x, v_y, v_z)</code> supports perpendicular (<span class="arithmatex">\(v_\perp\)</span>) and parallel (<span class="arithmatex">\(v_z\)</span>) components.</li>
<li>Explore speeds from <span class="arithmatex">\(10^4\)</span> to <span class="arithmatex">\(10^7\)</span> m/s to study trajectory shapes and Larmor radius.</li>
</ul>
</li>
<li>
<p><strong>Charge and Mass (<span class="arithmatex">\(q\)</span>, <span class="arithmatex">\(m\)</span>)</strong>:</p>
<ul>
<li>Function <code>set_particle_properties(q, m)</code> adjusts <span class="arithmatex">\(q/m\)</span> for particles like electrons, protons, or hypothetical cases.</li>
<li>Analyze motion dependence on <span class="arithmatex">\(q/m\)</span>.</li>
</ul>
</li>
</ul>
<h3 id="2-effects-on-trajectories">2. Effects on Trajectories</h3>
<ul>
<li>
<p><strong>Uniform Magnetic Field</strong>:</p>
<ul>
<li>Higher <span class="arithmatex">\(B_z\)</span> tightens circular/helical paths by reducing <span class="arithmatex">\(r_L \propto 1/B\)</span>.</li>
<li>Larger <span class="arithmatex">\(v_\perp\)</span> increases <span class="arithmatex">\(r_L \propto v_\perp\)</span>.</li>
</ul>
</li>
<li>
<p><strong>Combined Fields</strong>:</p>
<ul>
<li>Increasing <span class="arithmatex">\(E_x\)</span> stretches trajectories, creating trochoidal paths.</li>
<li>Variations in <span class="arithmatex">\(\mathbf{v}_0\)</span> alter gyration and drift balance.</li>
</ul>
</li>
<li>
<p><strong>Crossed Fields</strong>:</p>
<ul>
<li><span class="arithmatex">\(E_x\)</span> and <span class="arithmatex">\(B_z\)</span> changes modify <span class="arithmatex">\(\mathbf{E} \times \mathbf{B}\)</span> drift velocity <span class="arithmatex">\(v_d \propto E_x/B_z\)</span>.</li>
</ul>
</li>
</ul>
<h3 id="3-larmor-radius-r_l">3. Larmor Radius (<span class="arithmatex">\(r_L\)</span>)</h3>
<p>The Larmor radius is:</p>
<div class="arithmatex">\[r_L = \frac{m v_\perp}{|q| B}\]</div>
<ul>
<li><strong>Dependence</strong>:<ul>
<li><span class="arithmatex">\(r_L \propto 1/B\)</span>: Tighter gyration with stronger <span class="arithmatex">\(B\)</span>.</li>
<li><span class="arithmatex">\(r_L \propto v_\perp\)</span>: Larger radius with higher <span class="arithmatex">\(v_\perp\)</span>.</li>
<li><span class="arithmatex">\(r_L \propto m\)</span> and <span class="arithmatex">\(r_L \propto 1/|q|\)</span>: Radius increases with mass and decreases with charge.</li>
</ul>
</li>
</ul>
<h3 id="4-drift-velocity-v_d">4. Drift Velocity (<span class="arithmatex">\(v_d\)</span>)</h3>
<p>For crossed fields (<span class="arithmatex">\(\mathbf{E} \perp \mathbf{B}\)</span>), the drift velocity is:</p>
<div class="arithmatex">\[\mathbf{v}_{E \times B} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}\]</div>
<ul>
<li><strong>Dependence</strong>:<ul>
<li><span class="arithmatex">\(v_d \propto E_x\)</span>: Faster drift with stronger <span class="arithmatex">\(E_x\)</span>.</li>
<li><span class="arithmatex">\(v_d \propto 1/B_z\)</span>: Slower drift with stronger <span class="arithmatex">\(B_z\)</span>.</li>
<li>Independent of <span class="arithmatex">\(\mathbf{v}\)</span>, <span class="arithmatex">\(q\)</span>, and <span class="arithmatex">\(m\)</span>.</li>
</ul>
</li>
</ul>
<h3 id="5-simulation-and-analysis">5. Simulation and Analysis</h3>
<ul>
<li>
<p><strong>Parameter Sweeps</strong>:</p>
<ul>
<li>Iterate over <span class="arithmatex">\(B_z\)</span>, <span class="arithmatex">\(E_x\)</span>, <span class="arithmatex">\(v_\perp\)</span>, and <span class="arithmatex">\(q/m\)</span>.</li>
<li>Solve ODEs for each set, storing trajectories.</li>
</ul>
</li>
<li>
<p><strong>Metrics</strong>:</p>
<ul>
<li>Compute <span class="arithmatex">\(r_L\)</span> from trajectory curvature.</li>
<li>Measure <span class="arithmatex">\(v_d\)</span> from guiding center displacement.</li>
</ul>
</li>
<li>
<p><strong>Visualization</strong>:</p>
<ul>
<li>Plot 3D trajectories, <span class="arithmatex">\(r_L\)</span> vs. <span class="arithmatex">\(B\)</span>, <span class="arithmatex">\(v_\perp\)</span>, <span class="arithmatex">\(q\)</span>, <span class="arithmatex">\(m\)</span>, and <span class="arithmatex">\(v_d\)</span> vs. <span class="arithmatex">\(E_x\)</span>, <span class="arithmatex">\(B_z\)</span>.</li>
</ul>
</li>
<li>
<p><strong>Validation</strong>:</p>
<ul>
<li>Compare numerical results with analytical predictions.</li>
<li>Verify expected scalings (e.g., <span class="arithmatex">\(r_L \propto 1/B\)</span>, <span class="arithmatex">\(v_d \propto E_x/B_z\)</span>).</li>
</ul>
</li>
</ul>
<p>This systematic approach highlights the Lorentz force's role in shaping particle motion under varying conditions.</p>
<h2 id="codes-and-plots">Codes And Plots</h2>
<p><img alt="alt text" src="../image.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Particle properties
q = 1.0  # Charge (C)
m = 0.001  # Mass (kg)

# Field configuration
B = np.array([0, 0, 1.0])  # Uniform magnetic field (T)
E = np.array([0, 0, 0])  # Zero electric field (V/m)

# Initial conditions
r0 = np.array([0, 0, 0])  # Initial position (m)
v0 = np.array([1.0, 0, 0])  # Initial velocity (m/s), perpendicular to B
v_perp = np.sqrt(v0[0]**2 + v0[1]**2)  # Perpendicular velocity

# Simulation parameters
T = 0.02  # Total time (s)
dt = 1e-5  # Time step (s)
steps = int(T / dt)
t = np.linspace(0, T, steps)

# Arrays to store trajectory
r = np.zeros((steps, 3))
v = np.zeros((steps, 3))
r[0] = r0
v[0] = v0

# RK4 integration
def lorentz_force(r, v, E, B):
    return (q / m) * (E + np.cross(v, B))

for i in range(steps - 1):
    k1_v = lorentz_force(r[i], v[i], E, B)
    k1_r = v[i]

    k2_v = lorentz_force(r[i] + 0.5 * dt * k1_r, v[i] + 0.5 * dt * k1_v, E, B)
    k2_r = v[i] + 0.5 * dt * k1_v

    k3_v = lorentz_force(r[i] + 0.5 * dt * k2_r, v[i] + 0.5 * dt * k2_v, E, B)
    k3_r = v[i] + 0.5 * dt * k2_v

    k4_v = lorentz_force(r[i] + dt * k3_r, v[i] + dt * k3_v, E, B)
    k4_r = v[i] + dt * k3_v

    v[i + 1] = v[i] + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r[i + 1] = r[i] + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)

# Calculate Larmor radius
r_L = m * v_perp / (abs(q) * np.linalg.norm(B))  # Theoretical Larmor radius

# 2D Plot
plt.figure(figsize=(8, 8))
plt.plot(r[:, 0], r[:, 1], label="Particle Trajectory", color="blue")
plt.scatter(0, 0, color="red", label="Origin", s=100)
plt.xlabel("x (m)")
plt.ylabel("y (m)")
plt.title("Circular Trajectory in Uniform Magnetic Field")
plt.grid(True)
plt.axis("equal")
plt.legend()

# Annotate Larmor radius
plt.annotate(f"Larmor radius: {r_L:.3f} m", xy=(0.1, 0.9), xycoords="axes fraction", fontsize=12)
plt.tight_layout()
plt.show()
</code></pre>
<p><img alt="alt text" src="../image-1.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Particle properties
q = 1.0  # Charge (C)
m = 0.001  # Mass (kg)

# Field configuration
B = np.array([0, 0, 1.0])  # Uniform magnetic field (T)
E = np.array([0, 0, 0])  # Zero electric field (V/m)

# Initial conditions
r0 = np.array([0, 0, 0])  # Initial position (m)
v0 = np.array([1.0, 0, 0.5])  # Initial velocity with z-component (m/s)
v_perp = np.sqrt(v0[0]**2 + v0[1]**2)  # Perpendicular velocity

# Simulation parameters
T = 0.05  # Total time (s)
dt = 1e-5  # Time step (s)
steps = int(T / dt)
t = np.linspace(0, T, steps)

# Arrays to store trajectory
r = np.zeros((steps, 3))
v = np.zeros((steps, 3))
r[0] = r0
v[0] = v0

# RK4 integration
def lorentz_force(r, v, E, B):
    return (q / m) * (E + np.cross(v, B))

for i in range(steps - 1):
    k1_v = lorentz_force(r[i], v[i], E, B)
    k1_r = v[i]

    k2_v = lorentz_force(r[i] + 0.5 * dt * k1_r, v[i] + 0.5 * dt * k1_v, E, B)
    k2_r = v[i] + 0.5 * dt * k1_v

    k3_v = lorentz_force(r[i] + 0.5 * dt * k2_r, v[i] + 0.5 * dt * k2_v, E, B)
    k3_r = v[i] + 0.5 * dt * k2_v

    k4_v = lorentz_force(r[i] + dt * k3_r, v[i] + dt * k3_v, E, B)
    k4_r = v[i] + dt * k3_v

    v[i + 1] = v[i] + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r[i + 1] = r[i] + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)

# Calculate Larmor radius and pitch
r_L = m * v_perp / (abs(q) * np.linalg.norm(B))  # Larmor radius
T_c = 2 * np.pi * m / (abs(q) * np.linalg.norm(B))  # Cyclotron period
pitch = v0[2] * T_c  # Helical pitch

# 3D Plot
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection="3d")
ax.plot(r[:, 0], r[:, 1], r[:, 2], label="Helical Trajectory", color="blue")
ax.scatter(0, 0, 0, color="red", label="Origin", s=100)
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_zlabel("z (m)")
ax.set_title("Helical Trajectory in Uniform Magnetic Field")
ax.legend()

# Annotate Larmor radius and pitch
ax.text2D(0.05, 0.95, f"Larmor radius: {r_L:.3f} m\nPitch: {pitch:.3f} m", transform=ax.transAxes, fontsize=12)
plt.tight_layout()
plt.show()
</code></pre>
<p><img alt="alt text" src="../image-2.png"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Particle properties
q = 1.0  # Charge (C)
m = 0.001  # Mass (kg)

# Field configuration
B = np.array([0, 0, 1.0])  # Magnetic field (T)
E = np.array([1e3, 0, 0])  # Electric field (V/m)

# Initial conditions
r0 = np.array([0, 0, 0])  # Initial position (m)
v0 = np.array([1.0, 0, 0.5])  # Initial velocity (m/s)
v_perp = np.sqrt(v0[0]**2 + v0[1]**2)  # Perpendicular velocity

# Simulation parameters
T = 0.05  # Total time (s)
dt = 1e-5  # Time step (s)
steps = int(T / dt)
t = np.linspace(0, T, steps)

# Arrays to store trajectory
r = np.zeros((steps, 3))
v = np.zeros((steps, 3))
r[0] = r0
v[0] = v0

# RK4 integration
def lorentz_force(r, v, E, B):
    return (q / m) * (E + np.cross(v, B))

for i in range(steps - 1):
    k1_v = lorentz_force(r[i], v[i], E, B)
    k1_r = v[i]

    k2_v = lorentz_force(r[i] + 0.5 * dt * k1_r, v[i] + 0.5 * dt * k1_v, E, B)
    k2_r = v[i] + 0.5 * dt * k1_v

    k3_v = lorentz_force(r[i] + 0.5 * dt * k2_r, v[i] + 0.5 * dt * k2_v, E, B)
    k3_r = v[i] + 0.5 * dt * k2_v

    k4_v = lorentz_force(r[i] + dt * k3_r, v[i] + dt * k3_v, E, B)
    k4_r = v[i] + dt * k3_v

    v[i + 1] = v[i] + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r[i + 1] = r[i] + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)

# Calculate Larmor radius and drift velocity
r_L = m * v_perp / (abs(q) * np.linalg.norm(B))  # Larmor radius
v_d = E[0] / B[2]  # E × B drift velocity (m/s)

# 3D Plot
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection="3d")
ax.plot(r[:, 0], r[:, 1], r[:, 2], label="Drift Trajectory", color="blue")
ax.scatter(0, 0, 0, color="red", label="Origin", s=100)
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_zlabel("z (m)")
ax.set_title("E × B Drift in Crossed Electric and Magnetic Fields")
ax.legend()

# Annotate Larmor radius and drift velocity
ax.text2D(0.05, 0.95, f"Larmor radius: {r_L:.3f} m\nDrift velocity: {v_d:.1f} m/s", transform=ax.transAxes, fontsize=12)
plt.tight_layout()
plt.show()
</code></pre>
<p><img alt="alt text" src="../helical_trajectory.gif"/></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib.animation import FuncAnimation
import imageio.v2 as imageio

# Particle properties
q = 1.0  # Charge (C)
m = 0.001  # Mass (kg)

# Field configuration
B = np.array([0, 0, 1.0])  # Uniform magnetic field (T)
E = np.array([0, 0, 0])  # Zero electric field (V/m)

# Initial conditions
r0 = np.array([0, 0, 0])  # Initial position (m)
v0 = np.array([1.0, 0, 0.5])  # Initial velocity with z-component (m/s)
v_perp = np.sqrt(v0[0]**2 + v0[1]**2)  # Perpendicular velocity

# Simulation parameters
T = 0.05  # Total time (s)
dt = 1e-5  # Time step (s)
steps = int(T / dt)
t = np.linspace(0, T, steps)

# Arrays to store trajectory
r = np.zeros((steps, 3))
v = np.zeros((steps, 3))
r[0] = r0
v[0] = v0

# RK4 integration
def lorentz_force(r, v, E, B):
    return (q / m) * (E + np.cross(v, B))

for i in range(steps - 1):
    k1_v = lorentz_force(r[i], v[i], E, B)
    k1_r = v[i]

    k2_v = lorentz_force(r[i] + 0.5 * dt * k1_r, v[i] + 0.5 * dt * k1_v, E, B)
    k2_r = v[i] + 0.5 * dt * k1_v

    k3_v = lorentz_force(r[i] + 0.5 * dt * k2_r, v[i] + 0.5 * dt * k2_v, E, B)
    k3_r = v[i] + 0.5 * dt * k2_v

    k4_v = lorentz_force(r[i] + dt * k3_r, v[i] + dt * k3_v, E, B)
    k4_r = v[i] + dt * k3_v

    v[i + 1] = v[i] + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r[i + 1] = r[i] + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)

# Calculate Larmor radius and pitch
r_L = m * v_perp / (abs(q) * np.linalg.norm(B))  # Larmor radius
T_c = 2 * np.pi * m / (abs(q) * np.linalg.norm(B))  # Cyclotron period
pitch = v0[2] * T_c  # Helical pitch

# Set up the figure and 3D axis
fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection="3d")
ax.set_xlabel("x (m)")
ax.set_ylabel("y (m)")
ax.set_zlabel("z (m)")
ax.set_title("Helical Trajectory in Uniform Magnetic Field")

# Initialize plot elements
line, = ax.plot([], [], [], label="Helical Trajectory", color="blue")
point, = ax.plot([], [], [], "o", color="red", label="Particle")
ax.legend()

# Set axis limits based on trajectory
ax.set_xlim(np.min(r[:, 0]) - 0.001, np.max(r[:, 0]) + 0.001)
ax.set_ylim(np.min(r[:, 1]) - 0.001, np.max(r[:, 1]) + 0.001)
ax.set_zlim(np.min(r[:, 2]) - 0.001, np.max(r[:, 2]) + 0.001)

# Annotate Larmor radius and pitch
ax.text2D(0.05, 0.95, f"Larmor radius: {r_L:.3f} m\nPitch: {pitch:.3f} m", transform=ax.transAxes, fontsize=12)

# Animation function
def update(frame):
    # Update the trajectory line up to the current frame
    line.set_data(r[:frame, 0], r[:frame, 1])
    line.set_3d_properties(r[:frame, 2])

    # Update the particle position
    point.set_data([r[frame, 0]], [r[frame, 1]])
    point.set_3d_properties([r[frame, 2]])

    return line, point

# Create animation
ani = FuncAnimation(fig, update, frames=range(0, steps, 100), interval=50, blit=True)

# Save animation as GIF using imageio
ani.save("helical_trajectory.gif", writer="imageio", fps=20)

# Close the plot to free memory
plt.close()
</code></pre>
<h1 id="conclusion">Conclusion</h1>
<p>The simulation of charged particle motion under the Lorentz force, defined as $ \mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right) $, provides a powerful framework for understanding the dynamics of charged particles in electromagnetic fields. Through a systematic approach encompassing theoretical analysis, numerical implementation, and visualization, this study has illuminated the diverse behaviors of particles in various field configurations and their relevance to real-world applications.</p>
<p>The exploration of applications highlighted the Lorentz force's critical role in systems such as cyclotrons, mass spectrometers, and tokamaks. In cyclotrons, the magnetic field $ \mathbf{B} $ induces circular orbits with a Larmor radius $ r_L = \frac{m v_\perp}{|q| B} $, while the electric field $ \mathbf{E} $ drives energy gain. Mass spectrometers leverage the charge-to-mass ratio $ q/m $ to separate ions, and tokamaks rely on magnetic confinement to sustain fusion plasmas, with $ \mathbf{E} \times \mathbf{B} $ drifts influencing stability. These applications underscore the need for precise field control to achieve desired particle trajectories.</p>
<p>The simulation framework, built using the fourth-order Runge-Kutta (RK4) method and Python libraries (NumPy, Matplotlib), enabled accurate numerical solutions to the equations of motion:</p>
<div class="arithmatex">\[
m \frac{d \mathbf{v}}{dt} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right), \quad \frac{d \mathbf{r}}{dt} = \mathbf{v}
\]</div>
<p>Modular code structures facilitated simulations across multiple field configurations, including uniform magnetic fields, combined electric and magnetic fields, and crossed fields. These simulations produced a rich array of trajectories—circular, helical, trochoidal, cycloidal, and chaotic—each validated against theoretical predictions such as the cyclotron frequency $ \omega = \frac{|q| B}{m} $ and drift velocities like $ \mathbf{v}_{E \times B} = \frac{\mathbf{E} \times \mathbf{B}}{B^2} $.</p>
<p>Parameter variations revealed the sensitivity of trajectories to field strengths ($ \mathbf{E} $, $ \mathbf{B} <span class="arithmatex">\(), initial velocity (\)</span> \mathbf{v}_0 <span class="arithmatex">\(), charge (\)</span> q <span class="arithmatex">\(), and mass (\)</span> m $). For instance, increasing $ B $ reduces $ r_L $, tightening gyration, while $ E $ enhances drifts in crossed fields. The charge-to-mass ratio $ q/m $ governs responsiveness to fields, critical in applications like mass spectrometry. Visualizations, including 2D plots for planar motion and 3D plots for complex trajectories, effectively communicated these effects, with annotations for physical quantities ensuring clarity.</p>
<p>The significance of these simulations lies in their ability to bridge theoretical electromagnetism with practical applications. By modeling phenomena like cyclotron motion, $ \mathbf{E} \times \mathbf{B} $ drifts, and gradient-B drifts, the study provides insights into the design of particle accelerators, analytical instruments, and fusion devices. The visualizations also serve as educational tools, making abstract concepts tangible for students and researchers.</p>
<p>Future extensions could enhance the framework's scope and realism:
- <strong>Non-Uniform Fields</strong>: Incorporate spatially varying $ \mathbf{E} $ and $ \mathbf{B} $ to model realistic systems like magnetic traps or stellar magnetic fields.
- <strong>Time-Varying Fields</strong>: Explore dynamic fields beyond simple oscillations, relevant to astrophysical plasmas or pulsed accelerators.
- <strong>Multi-Particle Interactions</strong>: Simulate collective effects in plasmas, accounting for inter-particle forces.
- <strong>Relativistic Effects</strong>: Extend the equations to include relativistic corrections for high-velocity particles, using $ \mathbf{F} = q \left( \mathbf{E} + \mathbf{v} \times \mathbf{B} \right) $ in the relativistic momentum form.</p>
<p>In conclusion, this study demonstrates the power of computational simulations in elucidating the Lorentz force's effects on charged particle dynamics. By integrating theoretical rigor, numerical precision, and clear visualizations, it offers a robust platform for both academic exploration and practical innovation in electromagnetic systems. The findings pave the way for advanced simulations that could further unravel the complexities of charged particle motion in diverse physical contexts.</p>
<h2 id="references">References</h2>
<ul>
<li>Griffiths, D. J. (2017). <em>Introduction to Electrodynamics</em>. Cambridge University Press.</li>
<li>Chen, F. F. (2016). <em>Introduction to Plasma Physics and Controlled Fusion</em>. Springer.</li>
<li>Press, W. H., Teukolsky, S. A., Vetterling, W. T., &amp; Flannery, B. P. (2007). <em>Numerical Recipes: The Art of Scientific Computing</em>. Cambridge University Press.</li>
</ul>
<h2 id="colab">Colab</h2>
<p><a href="https://colab.research.google.com/drive/10dyZ3mfA9qahmvPUWq4L96hODiezuAuw">Colab7</a></p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
